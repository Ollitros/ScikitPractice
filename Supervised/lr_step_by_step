from scipy.special import expit
from IBM_coarses.utils import reader


x0 = [2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1,
      3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3,
      2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1,
      3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3,
      2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1,
      3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3, 2, 3, 4, 1, 3]
x1 = [10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11,
      13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10,
      10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10,
      11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10,
      10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10,
      11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10, 10, 11, 13, 9, 14, 10]
y0 = 0
y1 = 1
alpha = 0.1
w = 1
b = 1


for i in range(100):
    for k, z in zip(x0, x1):
        prediction = expit(w*k + b)
        loss = prediction - y0
        w = w - alpha*loss*k
        b = b - alpha * loss

        prediction = expit(w*z + b)
        loss = prediction - y1
        w = w - alpha * loss*z
        b = b - alpha * loss

print('w = ', w, 'b = ', b)


print(expit(w*x0[0] + b))
print(expit(w*x1[0] + b))
